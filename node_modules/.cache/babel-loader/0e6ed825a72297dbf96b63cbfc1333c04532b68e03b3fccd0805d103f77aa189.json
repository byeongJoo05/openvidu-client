{"ast":null,"code":"\"use strict\";\n\n/*\n * (C) Copyright 2017-2022 OpenVidu (https://openvidu.io)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EventDispatcher = void 0;\nvar OpenViduLogger_1 = require(\"../OpenViduInternal/Logger/OpenViduLogger\");\nvar EventEmitter = require(\"wolfy87-eventemitter\");\n/**\n * @hidden\n */\nvar logger = OpenViduLogger_1.OpenViduLogger.getInstance();\nvar EventDispatcher = /** @class */function () {\n  function EventDispatcher() {\n    /**\n     * @hidden\n     */\n    this.userHandlerArrowHandler = new WeakMap();\n    /**\n     * @hidden\n     */\n    this.ee = new EventEmitter();\n  }\n  /**\n   * @hidden\n   */\n  EventDispatcher.prototype.onAux = function (type, message, handler) {\n    var arrowHandler = function arrowHandler(event) {\n      if (event) {\n        logger.debug(message, event);\n      } else {\n        logger.debug(message);\n      }\n      handler(event);\n    };\n    this.userHandlerArrowHandler.set(handler, arrowHandler);\n    this.ee.on(type, arrowHandler);\n    return this;\n  };\n  /**\n   * @hidden\n   */\n  EventDispatcher.prototype.onceAux = function (type, message, handler) {\n    var _this = this;\n    var arrowHandler = function arrowHandler(event) {\n      if (event) {\n        logger.debug(message, event);\n      } else {\n        logger.debug(message);\n      }\n      handler(event);\n      // Remove handler from map after first and only execution\n      _this.userHandlerArrowHandler.delete(handler);\n    };\n    this.userHandlerArrowHandler.set(handler, arrowHandler);\n    this.ee.once(type, arrowHandler);\n    return this;\n  };\n  /**\n   * @hidden\n   */\n  EventDispatcher.prototype.offAux = function (type, handler) {\n    if (!handler) {\n      this.ee.removeAllListeners(type);\n    } else {\n      // Must remove internal arrow function handler paired with user handler\n      var arrowHandler = this.userHandlerArrowHandler.get(handler);\n      if (!!arrowHandler) {\n        this.ee.off(type, arrowHandler);\n      }\n      this.userHandlerArrowHandler.delete(handler);\n    }\n    return this;\n  };\n  return EventDispatcher;\n}();\nexports.EventDispatcher = EventDispatcher;","map":{"version":3,"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;AAmBA;AAEA;AAEA;;;AAGA,IAAMA,MAAM,GAAmBC,+BAAc,CAACC,WAAW,EAAE;AAE3D;EAAA;IACI;;;IAGA,4BAAuB,GAA4D,IAAIC,OAAO,EAAE;IAChG;;;IAGA,OAAE,GAAG,IAAIC,YAAY,EAAE;EA2E3B;EApDI;;;EAGAC,+BAAK,GAAL,UAAMC,IAAY,EAAEC,OAAe,EAAEC,OAA+B;IAChE,IAAMC,YAAY,GAAG,SAAfA,YAAY,CAAIC,KAAK;MACvB,IAAIA,KAAK,EAAE;QACPV,MAAM,CAACW,KAAK,CAACJ,OAAO,EAAEG,KAAK,CAAC;OAC/B,MAAM;QACHV,MAAM,CAACW,KAAK,CAACJ,OAAO,CAAC;;MAEzBC,OAAO,CAACE,KAAK,CAAC;IAClB,CAAC;IACD,IAAI,CAACE,uBAAuB,CAACC,GAAG,CAACL,OAAO,EAAEC,YAAY,CAAC;IACvD,IAAI,CAACK,EAAE,CAACC,EAAE,CAACT,IAAI,EAAEG,YAAY,CAAC;IAC9B,OAAO,IAAI;EACf,CAAC;EAED;;;EAGAJ,iCAAO,GAAP,UAAQC,IAAY,EAAEC,OAAe,EAAEC,OAA+B;IAAtE;IACI,IAAMC,YAAY,GAAG,SAAfA,YAAY,CAAIC,KAAK;MACvB,IAAIA,KAAK,EAAE;QACPV,MAAM,CAACW,KAAK,CAACJ,OAAO,EAAEG,KAAK,CAAC;OAC/B,MAAM;QACHV,MAAM,CAACW,KAAK,CAACJ,OAAO,CAAC;;MAEzBC,OAAO,CAACE,KAAK,CAAC;MACd;MACAM,KAAI,CAACJ,uBAAuB,CAACK,MAAM,CAACT,OAAO,CAAC;IAChD,CAAC;IACD,IAAI,CAACI,uBAAuB,CAACC,GAAG,CAACL,OAAO,EAAEC,YAAY,CAAC;IACvD,IAAI,CAACK,EAAE,CAACI,IAAI,CAACZ,IAAI,EAAEG,YAAY,CAAC;IAChC,OAAO,IAAI;EACf,CAAC;EAED;;;EAGAJ,gCAAM,GAAN,UAAOC,IAAY,EAAEE,OAAgC;IACjD,IAAI,CAACA,OAAO,EAAE;MACV,IAAI,CAACM,EAAE,CAACK,kBAAkB,CAACb,IAAI,CAAC;KACnC,MAAM;MACH;MACA,IAAMG,YAAY,GAAG,IAAI,CAACG,uBAAuB,CAACQ,GAAG,CAACZ,OAAO,CAAC;MAC9D,IAAI,CAAC,CAACC,YAAY,EAAE;QAChB,IAAI,CAACK,EAAE,CAACO,GAAG,CAACf,IAAI,EAAEG,YAAY,CAAC;;MAEnC,IAAI,CAACG,uBAAuB,CAACK,MAAM,CAACT,OAAO,CAAC;;IAEhD,OAAO,IAAI;EACf,CAAC;EACL,sBAAC;AAAD,CAAC,EAnFD;AAAsBc","names":["logger","OpenViduLogger_1","getInstance","WeakMap","EventEmitter","EventDispatcher","type","message","handler","arrowHandler","event","debug","userHandlerArrowHandler","set","ee","on","_this","delete","once","removeAllListeners","get","off","exports"],"sources":["C:\\Users\\user\\Desktop\\openvidu-client\\node_modules\\openvidu-browser\\src\\OpenVidu\\EventDispatcher.ts"],"sourcesContent":["/*\n * (C) Copyright 2017-2022 OpenVidu (https://openvidu.io)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { Event } from '../OpenViduInternal/Events/Event';\nimport { EventMap } from '../OpenViduInternal/Events/EventMap/EventMap';\nimport { OpenViduLogger } from '../OpenViduInternal/Logger/OpenViduLogger';\n\nimport EventEmitter = require('wolfy87-eventemitter');\n\n/**\n * @hidden\n */\nconst logger: OpenViduLogger = OpenViduLogger.getInstance();\n\nexport abstract class EventDispatcher {\n    /**\n     * @hidden\n     */\n    userHandlerArrowHandler: WeakMap<(event: Event) => void, (event: Event) => void> = new WeakMap();\n    /**\n     * @hidden\n     */\n    ee = new EventEmitter();\n\n    /**\n     * Adds function `handler` to handle event `type`\n     *\n     * @returns The EventDispatcher object\n     */\n    abstract on<K extends keyof EventMap>(type: K, handler: (event: EventMap[K]) => void): this;\n\n    /**\n     * Adds function `handler` to handle event `type` just once. The handler will be automatically removed after first execution\n     *\n     * @returns The object that dispatched the event\n     */\n    abstract once<K extends keyof EventMap>(type: K, handler: (event: EventMap[K]) => void): this;\n\n    /**\n     * Removes a `handler` from event `type`. If no handler is provided, all handlers will be removed from the event\n     *\n     * @returns The object that dispatched the event\n     */\n    abstract off<K extends keyof EventMap>(type: K, handler?: (event: EventMap[K]) => void): this;\n\n    /**\n     * @hidden\n     */\n    onAux(type: string, message: string, handler: (event: Event) => void): EventDispatcher {\n        const arrowHandler = (event) => {\n            if (event) {\n                logger.debug(message, event);\n            } else {\n                logger.debug(message);\n            }\n            handler(event);\n        };\n        this.userHandlerArrowHandler.set(handler, arrowHandler);\n        this.ee.on(type, arrowHandler);\n        return this;\n    }\n\n    /**\n     * @hidden\n     */\n    onceAux(type: string, message: string, handler: (event: Event) => void): EventDispatcher {\n        const arrowHandler = (event) => {\n            if (event) {\n                logger.debug(message, event);\n            } else {\n                logger.debug(message);\n            }\n            handler(event);\n            // Remove handler from map after first and only execution\n            this.userHandlerArrowHandler.delete(handler);\n        };\n        this.userHandlerArrowHandler.set(handler, arrowHandler);\n        this.ee.once(type, arrowHandler);\n        return this;\n    }\n\n    /**\n     * @hidden\n     */\n    offAux(type: string, handler?: (event: Event) => void): EventDispatcher {\n        if (!handler) {\n            this.ee.removeAllListeners(type);\n        } else {\n            // Must remove internal arrow function handler paired with user handler\n            const arrowHandler = this.userHandlerArrowHandler.get(handler);\n            if (!!arrowHandler) {\n                this.ee.off(type, arrowHandler);\n            }\n            this.userHandlerArrowHandler.delete(handler);\n        }\n        return this;\n    }\n}\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}